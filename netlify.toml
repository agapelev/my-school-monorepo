# Общая среда
[build.environment]
  NODE_VERSION = "20"
  PNPM_VERSION = "8.15.0"

# ===== Mission Main (Astro + Netlify adapter) =====
[context."mission-main".build]
  base = "apps/mission-main"
  command = "pnpm install && pnpm run build"
  publish = "apps/mission-main/dist"

[context."mission-main".functions]
  directory = "apps/mission-main/.netlify/functions-internal"

# ===== Blog (Astro, Tailwind v3 пока) =====
[context."blog".build]
  base = "apps/blog"
  command = "pnpm install && pnpm run build"
  publish = "apps/blog/dist"

# ===== School Docs (Astro, Tailwind v3 пока) =====
[context."school-docs".build]
  base = "apps/school-docs"
  command = "pnpm install && pnpm run build"
  publish = "apps/school-docs/dist"

# ===== API Server (Next.js) =====
[context."api-server".build]
  base = "apps/api-server"
  command = "pnpm install && pnpm run build"
  # ВАЖНО: publish не указываем, плагин сам всё сделает

[[plugins]]
  package = "@netlify/plugin-nextjs"
